<style>
    .ct-series-a .ct-line,
.ct-series-a .ct-point {
  stroke: white;
}

    .ct-series-b .ct-line,
.ct-series-b .ct-point {
  stroke: green;
}

.ct-label {
 color:white;
 font-size: 11px;
 }

</style>
<div id ="charts" style="margin-top:40px;">


{% for device in devices %}
<div class="col-md-6">
    <div class="card">
        <div class="card-header"><canvas id="chart-{{device.id}}" width="600" height="400"></canvas></div>

        <div class="card-content">
            <h4 class="title text-center"> <i class="material-icons">{{ device.icon }}</i>{{ device.name }}</h4>
        </div>
        <div class="card-footer">
            <div class="stats">
            {% with device.statistics_set.all|slice:":1" as last_stat %}
                <i class="material-icons">access_time</i> последнее показание снято {{ last_stat.date_time|date:"D-Y-M" }}
            </div>
            {% endwith %}
        </div>
    </div>
</div>
{% endfor %}

</div>
<script>
        {% for device in devices %}
        {% with device.statistics_set.all as latest_stats %}

        var ctx = document.getElementById("chart-{{device.id}}").getContext("2d");

        var data = {
            labels: [{% for stat in latest_stats %}{% if forloop.counter|divisibleby:10 %} "{{ stat.date_time|date:"H:i"}}", {% endif %}  {% endfor %}],
            datasets: [
                {
                    strokeColor: "rgba(220,220,220,1)",
                    pointColor: "rgba(220,220,220,1)",
                    pointHighlightStroke: "rgba(220,220,220,1)",
                    data: [{% for stat in latest_stats %} {% if forloop.counter|divisibleby:10 %} "{{stat.value1}}", {% endif %} {% endfor %}]
                },
                {
                    fillColor: "rgba(151,187,205,0.2)",
                    strokeColor: "rgba(151,187,205,1)",
                    pointColor: "rgba(151,187,205,1)",
                    pointHighlightStroke: "rgba(151,187,205,1)",
                    data: [{% for stat in latest_stats %} {% if forloop.counter|divisibleby:10 %} "{{stat.value2}}", {% endif %} {% endfor %}]
                }
            ]
        };

        var myLineChart = Chart.Line(ctx, {
            data: data
        });

        {% endwith %}
        {% endfor %}

</script>
