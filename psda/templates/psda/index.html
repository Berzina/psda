{% extends "psda/header.html" %}

{% block content %}

    {% include 'psda/includes/navpanelindex.html' %}
    {% if tab == "scenarios" %}
        {% include 'psda/includes/scenariolist.html' %}
    {% endif %}
    {% if tab == "devices" %}
        {% include 'psda/includes/devicelist.html' %}
    {% endif %}
    {% if tab == "charts" %}
        <div class="input-group date col-md-6 col-xs-12" style="margin-top:20px;">
          <input type="text" class="form-control" id ="date" value="{{date}}"  style = "display: table-cell; padding: 0px">
            <span class="btn btn-white btn-just-icon" style = "display: table-cell; padding: 0px">
                <i class="glyphicon glyphicon-th"></i>
            </span>
            <span class="btn btn-white btn-just-icon hide" id="waiting"  style = "display: table-cell; padding: 0px">
                <i class="glyphicon glyphicon-hourglass animate-device-icon" aria-hidden="true"></i>
            </span>
        </div>
        <div id ="charts" style="margin-top:20px;">
            {% include 'psda/includes/chartlist.html' %}
        </div>
    {% endif %}

<script>

    drawCharts();

    $('.input-group.date').datepicker({
        format: "yyyy-mm-dd",
        autoclose: true
    });

    $('.input-group.date').on("changeDate", function() {
        $("#charts").empty();
        $("#waiting").removeClass("hide");

        var date = $('.input-group.date').datepicker('getFormattedDate');

        ajaxPost("{% url 'redraw_charts' %}",

            {'date': date},

             function(content){
                $("#waiting").addClass("hide");
                $("#charts").html(content.html);
                drawCharts();

             }
        )

    });
</script>
{% endblock %}

